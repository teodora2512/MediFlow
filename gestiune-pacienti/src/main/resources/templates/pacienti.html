<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous">

    <title>Gestiune Pacien»õi</title>
    <div class="alert alert-success mb-3" th:text="${welcome}">
        Bun venit!
    </div>


    <style>
        body {
            margin: 20px;
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
        }

        h3 {
            margin-bottom: 20px;
            font-weight: bold;
            color: #2c3e50;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 5px solid #007bff;
        }

        .card {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .table {
            margin-top: 20px;
        }

        th {
            background-color: #007bff !important;
            color: white;
        }
    </style>
</head>

<body>

<div class="container">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>üè• Gestiune Pacien»õi</h2>
        <form th:action="@{/logout}" method="post">
            <button type="submit" class="btn btn-danger btn-sm">Logout</button>
        </form>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <form method="post" th:action="@{/pacienti/operatii}">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <label class="form-label">CNP</label>
                        <input type="text" class="form-control form-control-sm" name="cnp"
                               placeholder="CNP (cheie)..." th:value="${cnpParam}">
                    </div>

                    <div class="col-md-3 mb-3">
                        <label class="form-label">Nume</label>
                        <input type="text" class="form-control form-control-sm" name="nume"
                               placeholder="Nume..." th:value="${numeParam}">
                    </div>

                    <div class="col-md-3 mb-3">
                        <label class="form-label">Prenume</label>
                        <input type="text" class="form-control form-control-sm" name="prenume"
                               placeholder="Prenume..." th:value="${prenumeParam}">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Diagnostic</label>
                        <input type="text" class="form-control form-control-sm" name="diagnostic"
                               placeholder="Diagnostic..." th:value="${diagnosticParam}">
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">Tratament</label>
                        <input type="text" class="form-control form-control-sm" name="tratament"
                               placeholder="Tratament..." th:value="${tratamentParam}">
                    </div>
                </div>


                <div class="d-flex gap-2 flex-wrap mt-3">
                    <div th:if="${isEditor}" class="d-flex gap-2">
                        <input type="submit" class="btn btn-primary btn-sm" name="adauga" value="Interneaza"/>
                        <input type="submit" class="btn btn-danger btn-sm" name="sterge" value="Sterge"/>
                        <input th:if="${isEditor}" type="submit" class="btn btn-warning btn-sm" name="modifica" value="Modifica"/>
                    </div>
                    <input type="submit" class="btn btn-info btn-sm" name="cauta" value="Cauta/Filtreaza"/>
                </div>
            </form>
        </div>
    </div>

    <h3 th:text="${str}">Lista pacien»õilor</h3>

    <table class="table table-striped table-bordered table-hover">
        <thead>
        <tr>
            <th>CNP</th>
            <th>Nume »ôi Prenume</th>
            <th>Diagnostic</th>
            <th>Tratament</th>
            <th>Internare</th>
            <th>Externare</th>
            <th>AdƒÉugat de</th>
            <th>Ac»õiuni</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="p : ${lista}">
            <td th:text="${p.cnp}">1234567890123</td>
            <td th:text="${p.nume} + ' ' + ${p.prenume}">Popescu Ion</td>
            <td th:text="${p.diagnostic}">Pneumonie</td>
            <td th:text="${p.tratament}">Antibiotice</td>
            <td th:text="${#temporals.format(p.dataInternarii, 'dd-MM-yyyy')}">2023-11-01</td>
            <td th:text="${p.dataExternarii} ? ${#temporals.format(p.dataExternarii, 'dd-MM-yyyy')} : 'Internat'">null</td>
            <td th:text="${p.utilizator != null ? p.utilizator.username : 'N/A'}">teodora25</td>
            <td>
                <div class="d-flex gap-1">
                    <!-- Buton Externare vizibil doar pentru editori »ôi dacƒÉ pacientul nu are data externarii -->
                    <form th:if="${isEditor and p.dataExternarii == null}" th:action="@{/pacienti/operatii}" method="post">
                        <input type="hidden" name="cnp" th:value="${p.cnp}"/>
                        <input type="submit" class="btn btn-success btn-sm" name="externare" value="Externare"/>
                    </form>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

</body>
</html>